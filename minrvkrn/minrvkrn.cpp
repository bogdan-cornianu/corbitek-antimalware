// minrvkrn.cpp : Defines the exported functions for the DLL application.
//
#include "stdafx.h"
#include <tchar.h>
#include <iostream>
#include "minrvkrn.h"
#include "FileScan.h"
#include "GenericFile.h"
#include "PEFile.h"
#include <process.h>
#include "DB.h"
#include "Cleaner.h"

#define DLL_EXPORT

const char* urlt;
const char* usernamet;
const char* passwordt;

extern "C"
{
	DB db;
	FileScan fs;
	Cleaner df;

int MalSum(TCHAR *filename, int heur_level)
{	
	int result = fs.Scan(filename, heur_level);

	return result;
}


bool RemoveThreat(TCHAR *filename)
{
	return df.DeleteThreat(filename);
}


void ConnectToDB(const char* url, const char* username, const char* password)
{
	db.connection = db.Connect(url, username, password);
	fs.dbhandle = db;
	
}

void DisconnectFromDB()
{
	db.Disconnect();
}


}