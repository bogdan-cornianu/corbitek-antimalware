#pragma once
#include <string>
#include <mysql++.h>


class DB
{
public:
	DB(void);
	TCHAR* GetURL(void);
	TCHAR* GetUser(void);
	TCHAR* GetPassword(void);
	bool CheckConectivity(TCHAR* url);
	mysqlpp::Connection Connect(const char* url, const char* username, const char* password);
	const char* Disconnect(void);
	wstring ExecuteQuery(wstring query);
	int GetTotalDetections(void);
	int GetExactDetections(void);
	int GetGenericDetections(void);
	int GetVulnerabilityDetections(void);
	int GetWhiteListDetections(void);
	int GetGrayListDetections(void);
	mysqlpp::Connection connection;
	~DB(void);
};

